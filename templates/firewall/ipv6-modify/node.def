tag:

type: txt

syntax:expression: exec "		   	                    \
        if [ `echo -n '$VAR(@)' | wc -c` -gt 29 ]; then           \
          echo  firewall ipv6-modify must be 29 characters or less; \
          exit 1 ;                                                  \
        fi ; "

syntax:expression: pattern $VAR(@) "^[^-]" ; "Firewall rule set name cannot start with \"-\""

syntax:expression: pattern $VAR(@) "^[^;]*$" ; "Firewall rule set name cannot contain ';'"

syntax:expression: pattern $VAR(@) "^[^VZONE]" ; "Firewall rule set name cannot start with \"VZONE\""

end: if sudo /opt/vyatta/sbin/vyatta-firewall.pl --update-rules ipv6-modify "$VAR(@)" ;
     then
       if [ ${COMMIT_ACTION} = 'DELETE' ] ; 
       then
          if sudo /opt/vyatta/sbin/vyatta-firewall.pl --teardown-ok ipv6-modify ; 
          then
             sudo /opt/vyatta/sbin/vyatta-firewall.pl --teardown ipv6-modify
          fi
       fi
     else
       exit 1;
     fi

create: sudo /opt/vyatta/sbin/vyatta-firewall.pl --setup ip6tables ipv6-modify

help: Set IPv6 modify rule set name
